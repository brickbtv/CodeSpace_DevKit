REGISTERS = {
    'A': 0x00,
    'B': 0x01,
    'C': 0x02,
    'X': 0x03,
    'Y': 0x04,
    'Z': 0x05,
    'I': 0x06,
    'J': 0x07,
    'PUSH': 0x18,
    'POP': 0x18,
    'PEEK': 0x19,
    'SP': 0x1b,
    'PC': 0x1c,
    'EX': 0x1d,
}

BIN2REGISTERS = {v: k for k, v in REGISTERS.items()}

LITERAL = {
    -1: 0x20,
    **{i: 0x21 + i for i in range(31)}
}

MNEMONIC_TO_CODE = {
    'unused0': 0x00,
    'SET': 0x01,
    'ADD': 0x02,
    'SUB': 0x03,
    'MUL': 0x04,
    'MLI': 0x05,
    'DIV': 0x06,
    'DVI': 0x07,
    'MOD': 0x08,
    'MDI': 0x09,
    'AND': 0x0a,
    'BOR': 0x0b,
    'XOR': 0x0c,
    'SHR': 0x0d,
    'ASR': 0x0e,
    'SHL': 0x0f,
    'IFB': 0x10,
    'IFC': 0x11,
    'IFE': 0x12,
    'IFN': 0x13,
    'IFG': 0x14,
    'IFA': 0x15,
    'IFL': 0x16,
    'IFU': 0x17,
    'unused1': 0x18,
    'unused2': 0x19,
    'ADX': 0x1a,
    'SBX': 0x1b,
    'unused3': 0x1c,
    'unused4': 0x1d,
    'STI': 0x1e,
    'STD': 0x1f,
}

SPECIAL_MNEMONICS_TO_CODE = {
    'unused00': 0x00,
    'JSR': 0x01,
    'unused5': 0x02,
    'unused6': 0x03,
    'unused7': 0x04,
    'unused8': 0x05,
    'unused9': 0x06,
    'unused10': 0x07,
    'INT': 0x08,
    'IAG': 0x09,
    'IAS': 0x0a,
    'RFI': 0x0b,
    'IAQ': 0x0c,
    'unused11': 0x0d,
    'unused12': 0x0e,
    'unused13': 0x0f,
    'HWN': 0x10,
    'HWQ': 0x11,
    'HWI': 0x12,
    'unused14': 0x13,
    'unused15': 0x14,
    'unused16': 0x15,
    'unused17': 0x16,
    'unused18': 0x17,
    'unused19': 0x18,
    'unused20': 0x19,
    'unused21': 0x1a,
    'unused22': 0x1b,
    'unused23': 0x1c,
    'unused24': 0x1d,
    'unused25': 0x1e,
    'BRK': 0x1f,
}

BIN2OPCODE = {v: k for k, v in MNEMONIC_TO_CODE.items()}
BIN2SPECTIAL = {v: k for k, v in SPECIAL_MNEMONICS_TO_CODE.items()}


TESTSET = [
    '7fc1', 'ffff', '0104', '7fc1', 'ffff', '0106', '7c20', '00dc',
    '1e00', '7cc1', '0000', '1a20', '7c32', '30cf', '7c12', '7406',
    '1bc1', '0104', '7c32', '7349', '7c12', 'f615', '1bc1', '0106',
    '7cc2', '0001', '1cd6', '7f81', '000b', '7fd2', 'ffff', '0106',
    '7f81', '0103', '7fd3', 'ffff', '0104', '7f81', '002d', '7c01',
    '013b', '7c20', '00ed', '7f81', '0103', '7c01', '0000', '7c21',
    '01a2', '7a40', '0106', '7c01', '0003', '7c21', '0001', '7a40',
    '0106', '7c01', '0003', '7821', '0105', '7a40', '0104', '7c01',
    '0000', '7a40', '0104', '1e00', '7cf6', '0008', '7f81', '0057',
    '7cc1', '0000', '7cd2', '0008', '7f81', '005d', '1a20', '7cc2',
    '0001', '7c32', 'a474', '7c12', '8683', '7f81', '004a', '7c01',
    '0107', '7c20', '00ed', '7f81', '0103', '7d40', '00d2', '7c20',
    '00dc', '7c01', '0157', '7c20', '00ed', '7fc1', '0001', '0195',
    '7fd2', '0000', '0195', '7f81', '0068', '7fc1', '0000', '0195',
    '7cc1', '0000', '7c01', '0002', '5821', '0196', '7a40', '0104',
    '0ac1', '019c', '7cc2', '0001', '7cd6', '0006', '7f81', '0074',
    '7c01', '0000', '7c21', '0000', '7fd2', '0001', '019c', '7c21',
    '00ff', '7e40', '0000', '7e40', '0001', '7c21', '0000', '7fd2',
    '0001', '019e', '7c21', '00ff', '7e40', '0002', '7e40', '0003',
    '7c21', '0000', '7fd2', '0001', '019f', '7c21', '00ff', '7fd2',
    '0001', '01a1', '7c21', '00ff', '7e40', '0004', '7c21', '0000',
    '7fd2', '0001', '019f', '7c21', '00ff', '7fd2', '0001', '01a0',
    '7c21', '00ff', '7e40', '0005', '7c21', '0000', '7fd2', '0001',
    '019d', '7c21', '00ff', '7fd2', '0001', '01a0', '7c21', '00ff',
    '7e40', '0006', '7c21', '0000', '7fd2', '0001', '019d', '7c21',
    '00ff', '7fd2', '0001', '01a1', '7c21', '00ff', '7e40', '0007',
    '7f81', '0068', '7812', '0105', '7c20', '00d8', '7d60', '0000',
    '7fc1', '0001', '0195', '6381', '1b01', '1f01', '7cc1', '01a2',
    '7ce1', '0180', '18e2', '7dc1', '0020', '7cc2', '0001', '1cd3',
    '7f81', '00e3', '60e1', '60c1', '6381', '1b01', '1f01', '0701',
    '7cc1', '01a2', '00e1', '3c21', '7c2b', '7000', '05c1', '7cc2',
    '0001', '7ce2', '0001', '7df3', '0000', '7f81', '00f3', '6021',
    '60e1', '60c1', '6381', '0000', '0000', '0001', '0000', '0048',
    '0061', '0072', '0064', '0077', '0061', '0072', '0065', '0020',
    '0030', '002d', '0037', '0020', '0065', '0078', '0070', '0065',
    '0063', '0074', '0065', '0064', '0020', '0074', '006f', '0020',
    '0062', '0065', '0020', '0020', '0020', '0020', '0020', '0074',
    '0068', '0072', '0075', '0073', '0074', '0065', '0072', '0073',
    '002e', '0020', '0048', '0061', '006c', '0074', '0069', '006e',
    '0067', '002e', '0000', '004e', '006f', '0020', '006b', '0065',
    '0079', '0062', '006f', '0061', '0072', '0064', '0020', '0066',
    '006f', '0075', '006e', '0064', '002e', '0020', '0048', '0061',
    '006c', '0074', '0069', '006e', '0067', '002e', '0000', '0053',
    '0074', '0065', '0065', '0072', '0020', '0073', '0068', '0069',
    '0070', '0020', '0077', '0069', '0074', '0068', '0020', '0057',
    '0041', '0053', '0044', '0020', '002b', '0020', '0051', '0045',
    '0020', '0020', '0020', '0020', '0020', '0020', '0020', '0045',
    '006e', '0073', '0075', '0072', '0065', '0020', '0074', '0068',
    '0069', '0073', '0020', '0077', '0069', '006e', '0064', '006f',
    '0077', '0020', '0068', '0061', '0073', '0020', '0066', '006f',
    '0063', '0075', '0073', '002e', '0000', '0000', '0077', '0061',
    '0073', '0064', '0071', '0065', '0000', '0000', '0000', '0000',
    '0000', '0000', '0020', '0020', '0020', '0020', '0020', '0020',
    '0020', '0020', '0020', '0020', '0020', '0020', '0020', '0020',
]


# font + palette from https://gist.github.com/SylvainBoilard

LEM1802_FONT = [
    0xb79e, 0x388e, 0x722c, 0x75f4, 0x19bb, 0x7f8f, 0x85f9, 0xb158,
    0x242e, 0x2400, 0x082a, 0x0800, 0x0008, 0x0000, 0x0808, 0x0808,
    0x00ff, 0x0000, 0x00f8, 0x0808, 0x08f8, 0x0000, 0x080f, 0x0000,
    0x000f, 0x0808, 0x00ff, 0x0808, 0x08f8, 0x0808, 0x08ff, 0x0000,
    0x080f, 0x0808, 0x08ff, 0x0808, 0x6633, 0x99cc, 0x9933, 0x66cc,
    0xfef8, 0xe080, 0x7f1f, 0x0701, 0x0107, 0x1f7f, 0x80e0, 0xf8fe,
    0x5500, 0xaa00, 0x55aa, 0x55aa, 0xffaa, 0xff55, 0x0f0f, 0x0f0f,
    0xf0f0, 0xf0f0, 0x0000, 0xffff, 0xffff, 0x0000, 0xffff, 0xffff,
    0x0000, 0x0000, 0x005f, 0x0000, 0x0300, 0x0300, 0x3e14, 0x3e00,
    0x266b, 0x3200, 0x611c, 0x4300, 0x3629, 0x7650, 0x0002, 0x0100,
    0x1c22, 0x4100, 0x4122, 0x1c00, 0x1408, 0x1400, 0x081c, 0x0800,
    0x4020, 0x0000, 0x0808, 0x0800, 0x0040, 0x0000, 0x601c, 0x0300,
    0x3e49, 0x3e00, 0x427f, 0x4000, 0x6259, 0x4600, 0x2249, 0x3600,
    0x0f08, 0x7f00, 0x2745, 0x3900, 0x3e49, 0x3200, 0x6119, 0x0700,
    0x3649, 0x3600, 0x2649, 0x3e00, 0x0024, 0x0000, 0x4024, 0x0000,
    0x0814, 0x2241, 0x1414, 0x1400, 0x4122, 0x1408, 0x0259, 0x0600,
    0x3e59, 0x5e00, 0x7e09, 0x7e00, 0x7f49, 0x3600, 0x3e41, 0x2200,
    0x7f41, 0x3e00, 0x7f49, 0x4100, 0x7f09, 0x0100, 0x3e41, 0x7a00,
    0x7f08, 0x7f00, 0x417f, 0x4100, 0x2040, 0x3f00, 0x7f08, 0x7700,
    0x7f40, 0x4000, 0x7f06, 0x7f00, 0x7f01, 0x7e00, 0x3e41, 0x3e00,
    0x7f09, 0x0600, 0x3e41, 0xbe00, 0x7f09, 0x7600, 0x2649, 0x3200,
    0x017f, 0x0100, 0x3f40, 0x3f00, 0x1f60, 0x1f00, 0x7f30, 0x7f00,
    0x7708, 0x7700, 0x0778, 0x0700, 0x7149, 0x4700, 0x007f, 0x4100,
    0x031c, 0x6000, 0x0041, 0x7f00, 0x0201, 0x0200, 0x8080, 0x8000,
    0x0001, 0x0200, 0x2454, 0x7800, 0x7f44, 0x3800, 0x3844, 0x2800,
    0x3844, 0x7f00, 0x3854, 0x5800, 0x087e, 0x0900, 0x4854, 0x3c00,
    0x7f04, 0x7800, 0x447d, 0x4000, 0x2040, 0x3d00, 0x7f10, 0x6c00,
    0x417f, 0x4000, 0x7c18, 0x7c00, 0x7c04, 0x7800, 0x3844, 0x3800,
    0x7c14, 0x0800, 0x0814, 0x7c00, 0x7c04, 0x0800, 0x4854, 0x2400,
    0x043e, 0x4400, 0x3c40, 0x7c00, 0x1c60, 0x1c00, 0x7c30, 0x7c00,
    0x6c10, 0x6c00, 0x4c50, 0x3c00, 0x6454, 0x4c00, 0x0836, 0x4100,
    0x0077, 0x0000, 0x4136, 0x0800, 0x0201, 0x0201, 0x0205, 0x0200
]

LEM1802_PALETTE = [
    0x0000, 0x000a, 0x00a0, 0x00aa, 0x0a00, 0x0a0a, 0x0a50, 0x0aaa,
    0x0555, 0x055f, 0x05f5, 0x05ff, 0x0f55, 0x0f5f, 0x0ff5, 0x0fff
]
